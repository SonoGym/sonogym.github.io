<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SonoGym: High Performance Simulation</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 40px 20px;
      color: #222;
    }

     .container {
      max-width: 900px;
      margin: 0 auto;
      background: #fff;
      padding: 40px 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
      text-align: center;
    }

    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: center;
      margin: 25px 0;
    }

    .pill-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 18px;
      background-color: #111;
      color: white;
      text-decoration: none;
      border-radius: 999px;
      font-size: 0.95rem;
      transition: background 0.3s ease;
    }

    .pill-btn:hover {
      background-color: #333;
    }

    .pill-btn img {
      height: 16px;
    }

    .pill-btn i {
      font-size: 14px;
    }
    .pill-btn i.fab.fa-github {
      color: white;
    }

    h1 {
      font-size: 2.4rem;
      margin-bottom: 16px;
    }

    .authors, .affiliations {
      font-size: 1rem;
      color: #555;
      margin-bottom: 10px;
    }

    .author-note {
      font-size: 0.9rem;
      color: #888;
      margin-bottom: 20px;
    }

    h2 {
      font-size: 1.8rem;
      border-bottom: 2px solid #eee;
      padding-bottom: 6px;
      margin-top: 50px;
      margin-bottom: 20px;
    }

    h3 {
      font-size: 1.3rem;
      margin-top: 40px;
      margin-bottom: 10px;
      color: #333;
      text-align: left;
    }

    /* Center the whole abstract while ensuring left alignment for the last line */
    .abstract {
      text-align: center;
      display: inline-block;
      width: 100%;
    }

    p {
      font-size: 1rem;
      line-height: 1.6;
      text-align: justify;
      text-align-last: left;
      color: #333;
    }


      .videos-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-bottom: 30px;
    }
  
      .video-wrapper {
      flex: 1 1 45%;
      max-width: 500px;
      background: #f1f1f1;
      padding: 12px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
  
      video {
      width: 100%;
      height: auto;
      border-radius: 6px;
      margin-top: 10px;
    }
  
      /* Video titles */
      .video-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-top: 10px;
      text-align: center;
    }
     @media (max-width: 768px) {
      .video-wrapper {
        flex: 1 1 100%;
      }

      h1 {
        font-size: 1.8rem;
      }

      h2 {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>

  <div class="container">

    <h1>SonoGym: High Performance Simulation for Challenging Surgical Tasks with Robotic Ultrasound</h1>
  

    <div class="authors">
      Yunke Ao<sup>1,4,5</sup>, 
      Masoud Moghani<sup>2,6</sup><sup>*</sup>, 
      Mayank Mittal<sup>1,6</sup><sup>*</sup>, 
      Manish Prajapat<sup>1,5</sup>, 
      Luohong Wu<sup>3,4</sup>, 
      Frederic Giraud<sup>3,4</sup>, 
      Fabio Carrillo<sup>4</sup>, 
      Andreas Krause<sup>1,5</sup>, 
      Philipp Fürnstahl<sup>3,4,5</sup>
    </div>

    <div class="author-note">
      <sup>*</sup>Equal second author contribution.
    </div>

    <div class="affiliations">
      <sup>1</sup>ETH Zurich &nbsp;·&nbsp;
      <sup>2</sup>University of Toronto &nbsp;·&nbsp;
      <sup>3</sup>University of Zurich &nbsp;·&nbsp;
      <sup>4</sup>Balgrist University Hospital &nbsp;·&nbsp;
      <sup>5</sup>ETH AI Center &nbsp;·&nbsp;
      <sup>6</sup>NVIDIA
    </div>

    <div class="button-row">
  
      <!-- GitHub with Octocat -->
      <a class="pill-btn" href="https://github.com/SonoGym/SonoGym" >
        <i class="fab fa-github" style="color: white;"></i>
        Code
      </a>
  
      <!-- Hugging Face with emoji face logo -->
      <a class="pill-btn" href="https://huggingface.co/datasets/yunkao/SonoGym_lerobot_dataset" target="_blank">
        <img src="https://huggingface.co/front/assets/huggingface_logo-noborder.svg" alt="Hugging Face logo">
        Data
      </a>

      <a class="pill-btn" href="https://huggingface.co/datasets/yunkao/SonoGym_assets_models" target="_blank">
        <img src="https://huggingface.co/front/assets/huggingface_logo-noborder.svg" alt="Hugging Face logo">
        Assets
      </a>
    </div>

    <img src="images/overview.svg" alt="Description of the image" width="700" height="auto">

    <h2>Abstract</h2>
    <div class="abstract">
      <p>
        We present <strong>SonoGym</strong>, a scalable simulation platform for robotic ultrasound, enabling parallel simulation across tens to hundreds of environments. Our framework supports realistic and real-time simulation of ultrasound data from CT-derived 3D models of the anatomy through both a physics-based and a Generative Adversarial Network (GAN) approach.
      
        Our framework enables the training of deep reinforcement learning (DRL) and recent imitation learning agents (IL) (vision transformers and diffusion policies) for ultrasound-guided <strong>navigation</strong>, anatomy <strong>reconstruction</strong> and <strong>surgery</strong>.
        We believe our simulation can facilitate research in robot learning approaches for such challenging robotic surgery applications.
        Future research directions include improving ultrasound simulation quality and diversity, modeling soft tissue deformation, scaling to larger patient populations, improving generalization over different patients, and validation with real systems in clinical settings.
      </p>
     
    </div>

    <h2>Tasks</h2>
    <h3>Ultrasound navigation</h3>

    <div class="abstract">
      <p>
        We demonstrate high-performance <strong>Proximal Policy Optimization</strong>, <strong>Action Chunking Transformer</strong> and <strong>Diffusion Policy</strong> agents for the navigation task.
        The bottom of the videos show the <strong>learning-based ultrasound simulation</strong> from the first 8 environments.
        The goal plane for navigation is the tranverse plane across the center of the L4 lumbar vertebra.
      </p>
     
    </div>

    <div class="videos-container">
        <div class="video-wrapper">
          <div class="video-title">Action Chunking Transformer</div>
          <video controls>
            <source src="videos/act_guidance.mp4" type="video/webm">
            Your browser does not support the video tag.
          </video>
        </div>
      </div>
      <div class="videos-container">
        <div class="video-wrapper">
          <div class="video-title">Diffusion Policy</div>
          <video controls>
            <source src="videos/dp_guidance.mp4" type="video/webm">
            Your browser does not support the video tag.
          </video>
        </div>
      </div>
    <div class="videos-container">
        <div class="video-wrapper">
        <div class="video-title">Proximal Policy Optimization</div>
          <video controls>
            <source src="videos/ppo_guidance.mp4" type="video/webm">
            Your browser does not support the video tag.
          </video>
        </div>
      </div>
      

    <h3>Ultrasound-based anatomy reconstruction</h3>
    <div class="abstract">
      <p>
        We support high-performing <strong>submodular Proximal Policy Optimization</strong> agents for the anatomy reconstruction task.
        We also show the reconstruction of the heuristic trajectory for comparison.
        The <strong>top right corner</strong> shows the <strong>real-time observation</strong> of the agent, which is the <strong>current surface reconstruction</strong> transformed to the ultrasound probe frame.
        The red vertebra model is only for visualization and is not included in the observation.
        The <strong>bottom right corner</strong> shows the <strong>reconstruction status</strong>.
        The <strong>covered</strong> and <strong>uncovered</strong> surface points are colored in <strong><span style="color: rgba(225, 225, 11, 0.926);">yellow</span></strong> and <strong><span style="color: rgba(62, 101, 178, 0.887);">blue</span></strong>, respectively.   
      </p>
     
    </div>
     



    <div class="videos-container">
        <div class="video-wrapper">
          <div class="video-title">Submodular Proximal Policy Optimization</div>
          <video controls>
            <source src="videos/ppo_reconstruction.mp4" type="video/webm">
            Your browser does not support the video tag.
          </video>
        </div>
      </div>
      <div class="videos-container">
        <div class="video-wrapper">
          <div class="video-title">Heuristic</div>
          <video controls>
            <source src="videos/heuristic_reconstruction.mp4" type="video/webm">
            Your browser does not support the video tag.
          </video>
        </div>
      </div>

    <h3>Ultrasound-guided surgery</h3>
   
    <div class="abstract">
      <p>
        We support high-performing safe <strong>Proximal Policy Optimization</strong> and <strong>Action Chunking Transformer</strong> agents for the <strong>ultrasound-guided surgery</strong> task.
        The right half of the videos show the trajectories (<span style="color: rgba(40, 192, 6, 0.945);">green</span>) from 50 environments towards the target L4 vertebra (<span style="color: rgba(6, 124, 192, 0.945);">blue</span>).
        The <strong>goal</strong> frame / end point for the trajectory is annotated in <span style="color: rgba(171, 6, 6, 0.945);">red</span>.
        For <strong>PPO + safety filter</strong>, predicted unsafe actions are <strong>stopped</strong> before entering the target vertebra.
      </p>

    <div class="videos-container">
        <div class="video-wrapper">
          <div class="video-title">Action Chunking Transformer</div>
          <video controls>
            <source src="videos/act_surgery.mp4" type="video/webm">
            Your browser does not support the video tag.
          </video>
        </div>
      </div>
      <div class="videos-container">
        <div class="video-wrapper">
          <div class="video-title">Proximal Policy Optimization</div>
          <video controls>
            <source src="videos/ppo_surgery.mp4" type="video/webm">
            Your browser does not support the video tag.
          </video>
        </div>
      </div>
    <div class="videos-container">
        <div class="video-wrapper">
        <div class="video-title">Proximal Policy Optimization + Safety filter</div>
          <video controls>
            <source src="videos/sppo_surgery.mp4" type="video/webm">
            Your browser does not support the video tag.
          </video>
        </div>
      </div>
  </div>

</body>
</html>
